- hosts: test-playground-controller
  roles:
    - role: ../..

- hosts: all
  tasks:
    - name: detected operating system
      debug:
        msg: "{{ ansible_distribution }} {{ ansible_distribution_version }}"

- hosts: test-playground
  tasks:
    - name: list systemd units
      command: systemctl list-units

    # Debian 8 and Ubuntu 16.04 need this
    - name: update apt cache
      apt:
        update_cache: true
      when: ansible_pkg_mgr == 'apt'

    - name: install ssh server
      package:
        name: openssh-server
        state: latest

    - name: start sshd service
      service:
        enabled: true
        name: sshd
        state: started
